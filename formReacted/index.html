<html>
    <head>
        <title>Solweavers Form Final</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="index.css">
        <script type="application/javascript" src="https://unpkg.com/react@16.0.0/umd/react.production.min.js"></script>
        <script type="application/javascript" src="https://unpkg.com/react-dom@16.0.0/umd/react-dom.production.min.js"></script>
        <script type="application/javascript" src="https://unpkg.com/babel-standalone@6.26.0/babel.js"></script>
    </head>
    
    <body>
        <div id="wrapper">
        <!-- <form name="form" id="formReset">
            
            <input type="text" name="First Name" placeholder="First Name" id="fname"required ></input>
            <input type="text" name="Last Name" placeholder="Last Name" id="lname"required ></input>
            <input type="date" name="bdaymonth" class="date" id="birth" ste="4"required ></input>
            <input type="number" name="number" step="0.0001" min="0" placeholder="Salary" class="salary" id="salary" required/>

            <br/>
            
            <div id="selGender">
                <input type="radio" name="gender" value="female">Female</input>
                <input type="radio" name="gender" value="male" checked>Male</input>
            </div>

            <br/>
            <h4>Mark Your Hobbies</h4>
            <input onClick="return KeepCount()" id="1" class="hobbies checkbox" type="checkbox" value="Reading" name="reading">Reading</input>
            <input onClick="return KeepCount()" id="2" class="hobbies checkbox" type="checkbox" value="Writing" name="writing">Writing</input>
            <input onClick="return KeepCount()" id="3" class="hobbies checkbox" type="checkbox" value="Coding" name="coding">Coding</input>
            <input onClick="return KeepCount()" id="4" class="hobbies checkbox" type="checkbox" value="Filmmaking" name="filmmaking">Filmmaking</input>
            <input onClick="return KeepCount()" id="5" class="hobbies checkbox" type="checkbox" value="Skiing" name="skiing">Skiing</input>
            <input onClick="return KeepCount()" id="6" class="hobbies checkbox" type="checkbox" value="Swimming" name="swimming">Swimming</input>
            
            
            <br/>
            <h4>Your Favorite Color</h4>
            <select id="colorList" onchange="getColorFunction()" required>
                    <option name="color" value="Red">Red</option>
                    <option name="color" value="Blue">Blue</option>
                    <option name="color" value="Yellow">Yellow</option>
                    <option name="color" value="Green">Green</option>
                    <option name="color" value="Black">Black</option>
                    <option name="color" value="White" selected>White</option>
            </select>
            <div id="colorBackG"></div>
                
            <h4>The Countries you'd Like to Visit</h4>
            <select name="countries" id="mySelectCountries" multiple>
                <option value="France" >France</option>
                <option value="Spain" >Spain</option>
                <option value="Sweden">Sweden</option>
                <option value="Swizerland" >Swizerland</option>
                <option value="Finland" >Finland</option>
            </select>
            <br/>
            <h4>Something Else You Want to Tell Us?</h4>
            <textarea onChange="alertFunc()" onkeyup="charsCounter()" id="textInput" minlength="30" maxlength="140"required></textarea>
            <span id="insChars" style="background-color: red">140</span>
            <br/>
            <input type="submit" value="submit" onclick="getSelHobbies(), getSelCountries(), saveData()">
        </form> -->
        <!-- <table id="myTable">
            <tr>
                <th>First Name</th>
                <th>Last Name</th>
                <th>DofBirth</th>
                <th>Salary</th>
                <th>Gender</th>
                <th>Hobbies</th>
                <th>Color</th>
                <th>Countries</th>
                <th>Additional Text</th>
            </tr>
        </table> -->
        </div>
        <script type="text/babel">
const rootElement = document.getElementById('wrapper')
const textRem = ''
const hobbies = []
const countries = []
const pushDataArray = JSON.parse(window.localStorage.getItem('data'));
class MainInfo extends React.Component{
    construtor(props){
        this.state = [
            {first_name: '',
            last_name: '',
            birth: '',
            salary: '',
            gender: '',
            hobbies: '',
            color: '',
            countries: '',
            additional_text: ''}
        ]
        
        this.handleChange1 = this.handleChange1.bind(this);
        this.handleChange2 = this.handleChange2.bind(this);
        this.handleChange3 = this.handleChange3.bind(this);
        this.handleChange4 = this.handleChange4.bind(this);
        this.handleChange5 = this.handleChange5.bind(this);
        this.handleChange6 = this.handleChange6.bind(this);
        this.handleChange7 = this.handleChange7.bind(this);
        this.handleChange8 = this.handleChange8.bind(this);
        this.handleChange9 = this.handleChange9.bind(this);
        this.uploadFunc = this.uploadFunc.bind(this);
        this.spliceFunct = this.spliceFunct.bind(this);
        this.handleChangeText = this.handleChangeText.bind(this);
    }

    uploadFunc() {
        document.form.reset()
        this.setState({hobbies: JSON.stringify(hobbies)})
        if(window.localStorage.getItem('data')){
        // alert('there is data in the storage already')
        pushDataArray.push(this.state)
        window.localStorage.setItem('data', JSON.stringify(pushDataArray))

        } else {
            // alert('another submission')
            let dataArray = []
            dataArray.push(this.state)
            window.localStorage.setItem('data', JSON.stringify(dataArray))
        }
    }

    spliceFunct(){
        pushDataArray.splice(i, 1);
        window.localStorage.setItem('data', JSON.stringify(pushDataArray))
    }

    handleChange1(event){
        this.setState({first_name: event.target.value}) 
    }

    handleChange2(event){
        this.setState({last_name: event.target.value})
    }

    handleChange3(event){
        this.setState({birth: event.target.value})
    }

    handleChange4(event){
        this.setState({salary: event.target.value})
    }

    handleChange5(event){
        this.setState({gender: event.target.value})
    }

    handleChange6(event){
        hobbies.push(event.target.value)
        this.setState({hobbies: JSON.stringify(hobbies)})
    }

    handleChange7(event){
        this.setState({color: event.target.value})
    }

    handleChange8(event){
        countries.push(event.target.value)
        this.setState({countries: JSON.stringify(countries)})
    }

    handleChange9(event){
        this.setState({additional_text: event.target.value})
    }

    handleChangeText(event){
        let textLeft = 140 - (event.target.value.length)
        document.getElementById('insCbackgroundColor').innerHTML = textLeft
        let textIn = document.getElementById('textInput').value.length
        if ( textIn < 30) {
            document.getElementById('insCbackgroundColor').style.backgroundColor =  'red';
        } else if (textIn < 140) {
            document.getElementById('insCbackgroundColor').style.backgroundColor =  'green';
        } else {
            document.getElementById('insCbackgroundColor').style.backgroundColor =  'blue';
        }
    }
    render() {
        let boxStyle = {
            backgroundColor: 'red'
        }
        return (
            <div>
            <form name="form">
                <input type="text" name="First Name" placeholder="First Name" id="fname" onBlur={event => this.handleChange1(event)} required></input>
                <input type="text" name="Last Name" placeholder="Last Name" id="lname" onBlur={event => this.handleChange2(event)} required></input>
                <input type="date" name="bdaymonth" class="date" id="birth" ste="4" onBlur={event => this.handleChange3(event)} required></input>
                <input type="number" name="number" step="0.0001" min="0" placeholder="Salary" class="salary" id="salary" onBlur={event => this.handleChange4(event)} required/>
                
                <br/>
                <br/>
                
                <label>
                    Female
                    <input type="radio" name="gender" value="female" onClick={event => this.handleChange5(event)}></input>    
                </label>
                <label>
                    Male
                    <input type="radio" name="gender" value="male" onClick={event => this.handleChange5(event)}></input>
                </label>

                <br/>
                <h4>Mark Your Hobbies</h4>
                <label>
                    Reading
                    <input onClick={event => this.handleChange6(event)} id="1" className="hobbies checkbox" type="checkbox" value="Reading" name="reading"></input>
                </label>

                <label>
                    Writing
                    <input onClick={event => this.handleChange6(event)} id="2" className="hobbies checkbox" type="checkbox" value="Writing" name="writing"></input>
                </label>

                <label>
                    Coding
                    <input onClick={event => this.handleChange6(event)} id="3" className="hobbies checkbox" type="checkbox" value="Coding" name="coding"></input>
                </label>

                <label>
                    Filmmaking
                    <input onClick={event => this.handleChange6(event)} id="4" className="hobbies checkbox" type="checkbox" value="Filmmaking" name="filmmaking"></input>
                </label>

                <label>
                    Skiing
                    <input onClick={event => this.handleChange6(event)} id="5" className="hobbies checkbox" type="checkbox" value="Skiing" name="skiing"></input>
                </label>

                <label>
                    Swimming
                    <input onClick={event => this.handleChange6(event)} id="6" className="hobbies checkbox" type="checkbox" value="Swimming" name="swimming"></input>
                </label>

                <br/>
                <h4>Your Favorite Color</h4>
                <select id="colorList" onBlur="getColorFunction()" required>      
                            <option name="color" value="Red" onClick={event => this.handleChange7(event)}>Red</option>
                            <option name="color" value="Blue" onClick={event => this.handleChange7(event)}>Blue</option>
                            <option name="color" value="Yellow" onClick={event => this.handleChange7(event)}>Yellow</option>
                            <option name="color" value="Green" onClick={event => this.handleChange7(event)}>Green</option>
                            <option name="color" value="Black" onClick={event => this.handleChange7(event)}>Black</option>
                            <option name="color" value="White" onClick={event => this.handleChange7(event)} selected>White</option>
                </select>

                <div id="colorBackG"></div>
                
                <h4>The Countries you'd Like to Visit</h4>
                <select name="countries" id="mySelectCountries" multiple>
                        <option value="France" onClick={event => this.handleChange8(event)}>France</option>
                        <option value="Spain" onClick={event => this.handleChange8(event)}>Spain</option>
                        <option value="Sweden" onClick={event => this.handleChange8(event)}>Sweden</option>
                        <option value="Swizerland" onClick={event => this.handleChange8(event)}>Swizerland</option>
                        <option value="Finland" onClick={event => this.handleChange8(event)}>Finland</option>
                </select>

                <br/>
                <h4>Something Else You Want to Tell Us?</h4>
                <textarea id="textInput" minlength="30" maxlength="140" required onBlur={event => this.handleChange9(event)} onChange={event => this.handleChangeText(event)}></textarea>
                <span id="insCbackgroundColor" style={boxStyle}>140</span>
                <br/>
                </form>
                <input type="submit" value="submit" onClick={() => {
                    this.uploadFunc()
                    this.props.action()
                }
                }/>
            </div>
        );
    }
}

class RowComponent extends React.Component{
    constructor(props) {
        super(props);
        this.state = {  value: 'true' }
        this.handleClick = this.handleClick.bind(this)
    }

    // componentDidUpdate(){
    //     alert('Component Updated')
    // }

    handleClick(index){
        // alert('handle Click')
        pushDataArray.splice(index, 1)
        window.localStorage.setItem('data', JSON.stringify(pushDataArray))
        if(this.state.value == 'true') {
            this.setState({value: 'false'})
        } else {
            this.setState({value: 'true'})
        }
    }

    render() {
        const bgStyle = {
            backgroundColor: this.props.pushDataArray.color
        }
        return(
            <tr>
                <td>{this.props.pushDataArray.first_name}</td>
                <td>{this.props.pushDataArray.last_name}</td>
                <td>{this.props.pushDataArray.birth}</td>
                <td>{this.props.pushDataArray.salary}</td>
                <td>{this.props.pushDataArray.gender}</td>
                <td>{this.props.pushDataArray.hobbies}</td>
                <td style={bgStyle}>{this.props.pushDataArray.color}</td>
                <td>{this.props.pushDataArray.countries}</td>
                <td>{this.props.pushDataArray.additional_text}</td>
                <button onClick={(index) => 
                    {
                        this.handleClick(index);
                        this.props.action()
                    }
                }>
                Delete
                </button>
                {/* 
                 {
                    for(i=0; i =pushDataArray.length; i++){
                        <button onClick={(i) => 
                            pushDataArray.splice(i, 1)
                            window.localStorage.setItem('data', JSON.stringify(pushDataArray))
                        }>Delete</button>
                    }
                }
                */}
            </tr>
        )
    }
}
class HTMLtable extends React.Component {
    constructor(props) {
        super(props);
        this.handler = this.handler.bind(this)
        this.state = { value: 'true' }
    }
    componentDidUpdate(){
        // alert('table updated')
    }
    handler(){
        if(this.state.value == 'true'){
            this.setState({value: 'false'})
        } else {
            this.setState({value: 'true'})
        }
    }
    render(){
        return(
            <table id="myTable">
                <tr>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>DofBirth</th>
                    <th>Salary</th>
                    <th>Gender</th>
                    <th>Hobbies</th>
                    <th>Color</th>
                    <th>Countries</th>
                    <th>Additional Text</th>
                </tr>
                {
                    pushDataArray.map((info) => {
                        return <RowComponent pushDataArray={info} action={this.handler} />
                    })
                }
                
            </table>
        )
    }
}

class App extends React.Component{
    constructor(props) {
        super(props);
        this.handler = this.handler.bind(this)
        this.state = { value: 'true' }
    }
    
    // componentDidUpdate(){
    //     alert('App updated')
    // }

    handler(){
        if(this.state.value == 'true'){
            this.setState({value: 'false'})
        } else {
            this.setState({value: 'true'})
        }
    }
    render(){
        return(
            <div>
                <MainInfo action={this.handler}/>
                <HTMLtable />
            </div>
        )
    }
}

ReactDOM.render(<App />, rootElement)
        </script>
    </body>
</html>